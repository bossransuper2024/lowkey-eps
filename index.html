<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Korean EPS Vocabulary Mastering</title>
<style>
body { font-family: Arial, sans-serif; background:#111; color:#fff; text-align:center; }
.container { max-width:800px; margin:auto; padding:20px; }
button { padding:10px 20px; margin:5px; border:none; border-radius:8px; cursor:pointer; }
.menu-btn { background:#1f1f1f; color:#fff; }
.category-btn { background:#2d2d2d; color:#fff; }
.card { margin-top:40px; font-size:48px; font-weight:bold; cursor:pointer; user-select:none; }
.sub { font-size:24px; margin-top:20px; color:#00ffcc; }
.hidden { display:none; }
.error { color:#ff4d4d; margin-top:15px; }
</style>
</head>
<body>
<div class="container">
<h1>Korean EPS Vocabulary Mastering</h1>

<!-- MODE MENU -->
<div id="modeMenu">
<h2>Select Mode</h2>
<button class="menu-btn" onclick="setMode(1)">1️⃣ Hangul → Reveal</button>
<button class="menu-btn" onclick="setMode(2)">2️⃣ Hangul + Reveal Auto</button>
</div>

<!-- CATEGORY MENU -->
<div id="categoryMenu" class="hidden">
<h2>Select Category</h2>
<div id="categories"></div>
<div id="errorMsg" class="error"></div>
</div>

<!-- FLASHCARD AREA -->
<div id="flashcard" class="hidden">
<h2 id="categoryTitle"></h2>
<div class="card" id="hangul"></div>
<div class="sub hidden" id="romanization"></div>
<div class="sub hidden" id="meaning"></div>
<div class="sub" id="tapInfo" style="cursor:pointer;">Tap here to reveal</div>
<br>
<button onclick="nextWord()">Next</button>
</div>
</div>

<script>
let vocabData = {};
let currentCategory = "";
let currentIndex = 0;
let mode = 1;

// Default fallback data
vocabData = {
  "Work": [
    { "hangul": "일", "romanization": "il", "meaning": "work" },
    { "hangul": "회사", "romanization": "hoesa", "meaning": "company" },
    { "hangul": "직장", "romanization": "jikjang", "meaning": "workplace" },
    { "hangul": "사장", "romanization": "sajang", "meaning": "boss" },
    { "hangul": "직원", "romanization": "jigwon", "meaning": "employee" },
    { "hangul": "근무", "romanization": "geunmu", "meaning": "duty / work" },
    { "hangul": "회의", "romanization": "hoei", "meaning": "meeting" },
    { "hangul": "보고서", "romanization": "bogoseo", "meaning": "report" },
    { "hangul": "일하다", "romanization": "ilhada", "meaning": "to work" },
    { "hangul": "출근", "romanization": "chulgeun", "meaning": "going to work" },
    { "hangul": "퇴근", "romanization": "toegeun", "meaning": "leaving work" },
    { "hangul": "근로자", "romanization": "geunroja", "meaning": "worker / laborer" },
    { "hangul": "월급", "romanization": "wolgeup", "meaning": "monthly salary" },
    { "hangul": "계약", "romanization": "gyeyak", "meaning": "contract" },
    { "hangul": "면접", "romanization": "myeonjeop", "meaning": "interview" },
    { "hangul": "휴가", "romanization": "hyuga", "meaning": "vacation / leave" },
    { "hangul": "사무실", "romanization": "samusil", "meaning": "office" },
    { "hangul": "업무", "romanization": "eobmu", "meaning": "task / duties" }
  ],

  "Food": [
    { "hangul": "밥", "romanization": "bap", "meaning": "rice / meal" },
    { "hangul": "물", "romanization": "mul", "meaning": "water" },
    { "hangul": "김치", "romanization": "gimchi", "meaning": "kimchi" },
    { "hangul": "국", "romanization": "guk", "meaning": "soup" },
    { "hangul": "고기", "romanization": "gogi", "meaning": "meat" },
    { "hangul": "과일", "romanization": "gwail", "meaning": "fruit" },
    { "hangul": "야채", "romanization": "yachae", "meaning": "vegetables" },
    { "hangul": "밥 먹었어요?", "romanization": "bap meogeosseoyo?", "meaning": "Did you eat?" },
    { "hangul": "맛있어요", "romanization": "masisseoyo", "meaning": "It's delicious" },
    { "hangul": "배고파요", "romanization": "baegopayo", "meaning": "I'm hungry" },
    { "hangul": "주문하다", "romanization": "jumunhada", "meaning": "to order (food)" },
    { "hangul": "계산하다", "romanization": "gyesanhada", "meaning": "to pay / check out" },
    { "hangul": "커피", "romanization": "keopi", "meaning": "coffee" },
    { "hangul": "차", "romanization": "cha", "meaning": "tea" },
    { "hangul": "빵", "romanization": "ppang", "meaning": "bread" }
  ]
};

// Try loading external JSON
fetch('vocab.json')
.then(res => res.json())
.then(data => { vocabData = data; })
.catch(() => { console.log("Using fallback data."); });

function setMode(selectedMode){
    mode = selectedMode;
    document.getElementById('modeMenu').classList.add('hidden');
    document.getElementById('categoryMenu').classList.remove('hidden');
    loadCategories();
}

function loadCategories(){
    let catDiv = document.getElementById('categories');
    let errorDiv = document.getElementById('errorMsg');
    catDiv.innerHTML = "";
    if(Object.keys(vocabData).length === 0){
        errorDiv.innerText = "No categories found. Check vocab.json file.";
        return;
    }
    for(let category in vocabData){
        let btn = document.createElement('button');
        btn.className = 'category-btn';
        btn.innerText = category;
        btn.onclick = () => selectCategory(category);
        catDiv.appendChild(btn);
    }
}

function selectCategory(category){
    currentCategory = category;
    currentIndex = 0;
    document.getElementById('categoryMenu').classList.add('hidden');
    document.getElementById('flashcard').classList.remove('hidden');
    document.getElementById('categoryTitle').innerText = category;
    showWord();
}

function showWord(){
    let word = vocabData[currentCategory][currentIndex];
    document.getElementById('hangul').innerText = word.hangul;
    document.getElementById('romanization').innerText = word.romanization;
    document.getElementById('meaning').innerText = word.meaning;
    document.getElementById('romanization').classList.add('hidden');
    document.getElementById('meaning').classList.add('hidden');
    document.getElementById('tapInfo').style.display = mode === 1 ? 'block' : 'none';

    if(mode === 2){
        reveal();
    }
}

// REVEAL FUNCTION
function reveal(){
    document.getElementById('romanization').classList.remove('hidden');
    document.getElementById('meaning').classList.remove('hidden');
    document.getElementById('tapInfo').style.display = 'none';
}

// NEXT WORD
function nextWord(){
    currentIndex++;
    if(currentIndex >= vocabData[currentCategory].length){
        currentIndex = 0;
    }
    showWord();
}

// SPACEBAR REVEAL (PC)
document.addEventListener('keydown', function(e){
    if(e.code === 'Space'){
        e.preventDefault();
        reveal();
    }
});

// TAP ON FLASHCARD TO REVEAL (MOBILE / TOUCH)
document.getElementById('hangul').addEventListener('click', function(){
    if(mode === 1){
        reveal();
    }
});
</script>
</body>
</html>
